This version generates all optimal solutions and does not bit-shift vertex and edge labels
