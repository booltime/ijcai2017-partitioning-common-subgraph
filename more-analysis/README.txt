NOTE: In the comparison of kup and kdown, runtimes of 0 ms are changed to 1 ms to avoid division by zero.
